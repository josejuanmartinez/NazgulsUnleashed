# Called from code once a quarter for "playable" (count+) characters.
# Root is the character
# scope:quarter is which quarter it's for, from 1 to 4. Note that scope:quarter = 1 isn't necessarily in Q1 by calendar time
quarterly_playable_pulse = {
	trigger = { is_wastelands = no } #LotR
	on_actions = {
		realm_maintenance_quarterly_pulse #LotR

		# Event pools
		stewardship_lifestyle_progress_pulse
		intrigue_lifestyle_progress_pulse
		diplomacy_lifestyle_progress_pulse
		martial_lifestyle_progress_pulse
		learning_lifestyle_progress_pulse

		# Relation pulses are spread out across the four quarterly pulses a year
		lover_quarterly_pulse
		friendship_quarterly_pulse
		rival_quarterly_pulse
		mentor_student_quarterly_pulse

		# EP1 maintenance pulses
		inspiration_maintenance_quarterly_pulse

		sorcery_quarterly_events_effect_pulse
		indur_quarterly_events_effect_pulse
		ovatha_colonization_effect_pulse
	}
}

sorcery_quarterly_events_effect_pulse = {
	trigger = { 
		is_wastelands = no 
		is_sorcerer = yes
		is_ai = yes
		is_human = no
		OR = {
			NOT = { has_character_modifier = practiced_sorcery_recently }
			AND = {
				root = character:nazgul5					
				any_courtier = {
					is_sorcerer = yes
					NOT = {
						has_character_modifier = practiced_sorcery_recently
					}
				}	
			}
		}
		piety > 0
	}
	effect = {
		sorcery_quarterly_events_effect = yes
	}
}

indur_quarterly_events_effect_pulse = {
	trigger = { 
		root = character:nazgul4
		root = {
			is_ai = yes
			is_human = no
		}
		character:nazgul4 = {
			is_ai = yes
			is_human = no
		}
		OR = {
			AND = {
				has_trait = indur_scheme_court			
				NOT = {
					has_character_modifier = schemed_recently
				}
			}			
			any_courtier = {
				has_trait = indur_scheme_court
				NOT = {
					has_character_modifier = schemed_recently
				}
			}	
		}
	}
	effect = {
		indur_quarterly_events_effect = yes
	}
}

ovatha_colonization_effect_pulse = {
	trigger = {
		root = character:nazgul9
		root = {
			is_ai = yes
			is_human = no
		}
	}
	# Only for AI, 50% of chance to considering colonisation once a year
	random_events = {
		chance_to_happen = 10
		1 = wastelands_nazguls.0006
	}	
}