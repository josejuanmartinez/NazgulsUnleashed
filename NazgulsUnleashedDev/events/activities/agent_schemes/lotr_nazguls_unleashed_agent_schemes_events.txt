namespace = agent_schemes

agent_schemes.0001 = {
	title = agent_schemes.0001.t
	desc = agent_schemes.0001.desc
	type = character_event
	content_source = realms_dlc
	theme = murder_scheme
	left_portrait = {
		character = root
		animation = personality_dishonorable
	}
	lower_center_portrait = {
		character = scope:selected_agent_1
		animation = personality_dishonorable
	}
	lower_left_portrait = {
		character = scope:selected_agent_2
		animation = personality_dishonorable
	}
	lower_right_portrait = {
		character = scope:selected_agent_3
		animation = personality_dishonorable
	}
	override_background = { reference = throne_room_evil }

	immediate = {
		play_music_cue = "mx_cue_illness"

		#add_character_flag = {
		#	flag = planning_an_activity
		#	days = 30
		#}

		generate_schemes_list_on_start = yes

		ordered_courtier = {
			limit = {
				has_trait = indur_scheme_court
				NOT = {
					has_character_modifier = schemed_recently
				}
			}
			order_by = intrigue
			save_scope_as = selected_agent_1
		}
		ordered_courtier = {
			limit = {
				has_trait = indur_scheme_court
				NOT = {
					has_character_modifier = schemed_recently
					this = scope:selected_agent_1
				}
			}
			order_by = intrigue
			save_scope_as = selected_agent_2
		}
		ordered_courtier = {
			limit = {
				has_trait = indur_scheme_court
				NOR = {
					has_character_modifier = schemed_recently
					this = scope:selected_agent_1
					this = scope:selected_agent_2
				}
			}
			order_by = intrigue
			save_scope_as = selected_agent_3
		}		
	}

	option = { # Caster 1
		trigger = {
			exists = scope:selected_agent_1
		}
		name = agent_schemes.0001.a
		set_variable = {
			name = selected_agent
			value = scope:selected_agent_1
		}
	}

	option = { # Caster 2
		trigger = {
			exists = scope:selected_agent_2
		}
		name = agent_schemes.0001.b
		set_variable = {
			name = selected_agent
			value = scope:selected_agent_2
		}
	}

	option = { # Caster 3
		trigger = {
			exists = scope:selected_agent_3
		}
		name = agent_schemes.0001.c
		set_variable = {
			name = selected_agent
			value = scope:selected_agent_3
		}
	}

	option = { # You will do it
		name = agent_schemes.0001.d
		set_variable = {
			name = selected_agent
			value = root
		}
	}

}

# Steal Money
agent_schemes.0010 = {
	title = agent_schemes.0010.t
	desc = agent_schemes.0010.desc
	type = character_event
	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = scope:ruler_1
		animation = bold
	}
	lower_left_portrait = {
		character = scope:ruler_2
		animation = bold
	}
	lower_center_portrait = {
		character = scope:ruler_3
		animation = bold
	}
	lower_right_portrait = {
		character = scope:ruler_4
		animation = bold
	}
	override_background = { reference = drylands }

	immediate = {
		if = {
			limit = {
				NOT = {
					exists = root.var:selected_agent
				}
			}
			if = {
				limit = {
					has_trait = indur_scheme_court
					NOT = {
						has_character_modifier = schemed_recently
					}
				}				
				set_variable = {
					name = selected_agent
					value = root
				}
			}					
			else = {
				random_courtier = {
					limit = {
						has_trait = indur_scheme_court
						NOT = {
							has_character_modifier = schemed_recently
						}
					}
					set_variable = {
						name = selected_agent
						value = this
					}
				}
			}
		}
		if = {
			limit = {
				exists = var:selected_agent
			}
			var:selected_agent = { add_character_modifier = {
				modifier = schemed_recently
				years = 4
			} }
		}
		random_ruler = {
			limit = {
				NOR = {
					culture = root.location.culture
					#culture_group = root.location.culture_group
					culture = root.culture
					#culture_group = root.culture_group
					faith = root.faith
					
					
					top_liege = root.top_liege
					capital_county.title_province = {
						is_wastelands = yes
					}
				}
			}
			save_scope_as = ruler_1
		}
	
		random_ruler = {
			limit = {
				NOR = {
					culture = root.location.culture
					#culture_group = root.location.culture_group
					culture = root.culture
					#culture_group = root.culture_group
					faith = root.faith
					
					
					top_liege = root.top_liege
					capital_county.title_province = {
						is_wastelands = yes
					}
					# Variety
					top_liege = scope:ruler_1.top_liege
					culture = scope:ruler_1.culture
					faith = scope:ruler_1.faith
				}
			}
			save_scope_as = ruler_2
		}
		random_ruler = {
			limit = {
				NOR = {
					culture = root.location.culture
					#culture_group = root.location.culture_group
					culture = root.culture
					#culture_group = root.culture_group
					faith = root.faith
					
					
					top_liege = root.top_liege
					capital_county.title_province = {
						is_wastelands = yes
					}
					# Variety
					top_liege = scope:ruler_1.top_liege
					culture = scope:ruler_1.culture
					faith = scope:ruler_1.faith

					# Variety
					top_liege = scope:ruler_2.top_liege
					culture = scope:ruler_2.culture
					faith = scope:ruler_2.faith
				}
			}
			save_scope_as = ruler_3
		}

		random_ruler = {
			limit = {
				NOR = {
					culture = root.location.culture
					#culture_group = root.location.culture_group
					culture = root.culture
					#culture_group = root.culture_group
					faith = root.faith
					
					
					top_liege = root.top_liege
					capital_county.title_province = {
						is_wastelands = yes
					}
					# Variety
					top_liege = scope:ruler_1.top_liege
					culture = scope:ruler_1.culture
					faith = scope:ruler_1.faith

					# Variety
					top_liege = scope:ruler_2.top_liege
					culture = scope:ruler_2.culture
					faith = scope:ruler_2.faith

					# Variety
					top_liege = scope:ruler_3.top_liege
					culture = scope:ruler_3.culture
					faith = scope:ruler_3.faith
				}
			}
			save_scope_as = ruler_4
		}

		if = {
			limit = {  scope:ruler_1 = { gold > 100 } }
			set_variable = {
				name = stolen_gold_1
				value = 100
			}						
		}
		else_if =  {
			limit = {  scope:ruler_1 = { gold > 75 } }
			set_variable = {
				name = stolen_gold_1
				value = 75
			}
		}
		else_if =  {
			limit = {  scope:ruler_1 = { gold > 50 } }
			set_variable = {
				name = stolen_gold_1
				value = 50
			}
		}
		else =  {
			set_variable = {
				name = stolen_gold_1
				value = 25
			}
		}

		if = {
			limit = {  scope:ruler_2 = { gold > 100 } }
			set_variable = {
				name = stolen_gold_2
				value = 100
			}						
		}
		else_if =  {
			limit = {  scope:ruler_2 = { gold > 75 } }
			set_variable = {
				name = stolen_gold_2
				value = 75
			}
		}
		else_if =  {
			limit = {  scope:ruler_2 = { gold > 50 } }
			set_variable = {
				name = stolen_gold_2
				value = 50
			}
		}
		else =  {
			set_variable = {
				name = stolen_gold_2
				value = 25
			}
		}

		if = {
			limit = {  scope:ruler_3 = { gold > 100 } }
			set_variable = {
				name = stolen_gold_3
				value = 100
			}						
		}
		else_if =  {
			limit = {  scope:ruler_3 = { gold > 75 } }
			set_variable = {
				name = stolen_gold_3
				value = 75
			}
		}
		else_if =  {
			limit = {  scope:ruler_3 = { gold > 50 } }
			set_variable = {
				name = stolen_gold_3
				value = 50
			}
		}
		else =  {
			set_variable = {
				name = stolen_gold_3
				value = 25
			}
		}

		if = {
			limit = {  scope:ruler_4 = { gold > 100 } }
			set_variable = {
				name = stolen_gold_4
				value = 100
			}						
		}
		else_if =  {
			limit = {  scope:ruler_4 = { gold > 75 } }
			set_variable = {
				name = stolen_gold_4
				value = 75
			}
		}
		else_if =  {
			limit = {  scope:ruler_4 = { gold > 50 } }
			set_variable = {
				name = stolen_gold_4
				value = 50
			}
		}
		else =  {
			set_variable = {
				name = stolen_gold_4
				value = 25
			}
		}
	}
	
	option = { # Ruler 1
		name = agent_schemes.0010.a
		trigger = {
			exists = scope:ruler_1
		}
		ai_chance = {
			base = 100
		}	
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				custom_tooltip = {
					text = agent_schemes.0010.a.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}	
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_1
					}
					set_variable = {
						name = stolen_gold
						value = root.var:stolen_gold_1
					}
					trigger_event = {
						id = agent_schemes.0011
						days = 15
					}
				}
			}
			50 = {
				custom_tooltip = {
					text = agent_schemes.0010.failure.desc
				}
				compare_modifier = {
					value = scope:ruler_1.cp:councillor_spymaster.intrigue
					multiplier = 2
				}
				modifier = {
					add = scope:ruler_1.capital_county.title_province.fort_level
					factor = 2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_1
					}
					trigger_event = {
						id = agent_schemes.0012
						days = 15
					}
				}
			}
		}
		}
	}
	
	option = { # Ruler 2
		name = agent_schemes.0010.b
		trigger = {
			exists = scope:ruler_2
		}
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0010.b.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_2
					}
					set_variable = {
						name = stolen_gold
						value = root.var:stolen_gold_2
					}
					trigger_event = {
						id = agent_schemes.0011
						days = 15
					}
				}
			}
			50 = {
				custom_tooltip = {
					text = agent_schemes.0010.failure.desc
				}
				compare_modifier = {
					value = scope:ruler_2.cp:councillor_spymaster.intrigue
					multiplier = 2
				}
				modifier = {
					add = scope:ruler_2.capital_county.title_province.fort_level
					factor = 2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_2
					}
					trigger_event = {
						id = agent_schemes.0012
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Ruler 3
		name = agent_schemes.0010.c
		trigger = {
			exists = scope:ruler_3
		}
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0010.c.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_3
					}
					set_variable = {
						name = stolen_gold
						value = root.var:stolen_gold_3
					}
					trigger_event = {
						id = agent_schemes.0011
						days = 15
					}
				}
			}
			50 = {
				custom_tooltip = {
					text = agent_schemes.0010.failure.desc
				}
				compare_modifier = {
					value = scope:ruler_3.cp:councillor_spymaster.intrigue
					multiplier = 2
				}
				modifier = {
					add = scope:ruler_3.capital_county.title_province.fort_level
					factor = 2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_3
					}
					trigger_event = {
						id = agent_schemes.0012
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Ruler 4
		name = agent_schemes.0010.d
		trigger = {
			exists = scope:ruler_4
		}
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0010.d.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_4
					}
					set_variable = {
						name = stolen_gold
						value = root.var:stolen_gold_4
					}
					trigger_event = {
						id = agent_schemes.0011
						days = 15
					}	
				}
			}
			50 = {
				custom_tooltip = {
					text = agent_schemes.0010.failure.desc
				}
				compare_modifier = {
					value = scope:ruler_4.cp:councillor_spymaster.intrigue
					multiplier = 2
				}
				modifier = {
					add = scope:ruler_4.capital_county.title_province.fort_level
					factor = 2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:ruler_4
					}
					trigger_event = {
						id = agent_schemes.0012
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # On a better thought
		name = agent_schemes.0010.e
		
		root.var:selected_agent = {
			remove_character_modifier = schemed_recently
		}
	}	
}

## Steal money: Success
agent_schemes.0011 = {
	title = agent_schemes.success.t
	desc = agent_schemes.success.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = {
		name = agent_schemes.option
		send_interface_toast = {
			title = agent_schemes.0010.tt.success
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim		
			
			root = { add_gold = root.var:stolen_gold }
			root.var:selected_victim = {
				remove_short_term_gold = root.var:stolen_gold
			}					
		}
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0010.revealed_secret.success.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0010.revealed_secret.success.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0010.rumour.t
						desc = agents_quarterly_events_effect.0010.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		}  }
	}
}

## Steal money: Failure
agent_schemes.0012 = {
	title = agent_schemes.failure.t
	desc = agent_schemes.failure.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = { # Failure
		name = agent_schemes.option
		send_interface_toast = {					
			title = agent_schemes.0010.tt.failure
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim
			root.var:selected_victim = {
				add_opinion = {
					target = root
					modifier = accused_crime_opinion
					opinion = -25
				}
			}
			root.var:selected_agent = {
				increase_wounds_effect = { REASON = fight }
			}
		}
		
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0010.revealed_secret.failure.t
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0010.revealed_secret.failure.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {						
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0010.rumour.t
						desc = agents_quarterly_events_effect.0010.rumour.desc
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}


# Steal Artifact
agent_schemes.0020 = {
	title = agent_schemes.0020.t
	desc = agent_schemes.0020.desc
	type = character_event
	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = scope:artifact_1.artifact_owner
		animation = bold
	}
	lower_left_portrait = {
		character = scope:artifact_2.artifact_owner
		animation = bold
	}
	lower_center_portrait = {
		character = scope:artifact_3.artifact_owner
		animation = bold
	}
	lower_right_portrait = {
		character = scope:artifact_4.artifact_owner
		animation = bold
	}
	override_background = { reference = drylands }

	immediate = {
		if = {
			limit = {
				NOT = {
					exists = root.var:selected_agent
				}
			}
			if = {
				limit = {
					has_trait = indur_scheme_court
					NOT = {
						has_character_modifier = schemed_recently
					}
				}				
				set_variable = {
					name = selected_agent
					value = root
				}
			}					
			else = {
				random_courtier = {
					limit = {
						has_trait = indur_scheme_court
						NOT = {
							has_character_modifier = schemed_recently
						}
					}
					set_variable = {
						name = selected_agent
						value = this
					}
				}
			}
		}
		if = {
			limit = {
				exists = var:selected_agent
			}
			var:selected_agent = { add_character_modifier = {
				modifier = schemed_recently
				years = 4
			} }
		}
		random_artifact = {
			limit = {
				artifact_owner = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						AND = {
							artifact_owner = { 
								is_nazgul = yes
							}
							is_nazgul = yes
						}
					}
				}
			}					
			save_scope_as = artifact_1
		}

		random_artifact = {
			limit = {
				artifact_owner = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						this = scope:artifact_1
						AND = {
							artifact_owner = { 
								is_nazgul = yes
							}
							is_nazgul = yes
						}
					}
				}
			}					
			save_scope_as = artifact_2
		}
		
		random_artifact = {
			limit = {
				artifact_owner = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						this = scope:artifact_1
						this = scope:artifact_2
						AND = {
							artifact_owner = { 
								is_nazgul = yes
							}
							is_nazgul = yes
						}
					}
				}
			}					
			save_scope_as = artifact_3
		}

		random_artifact = {
			limit = {
				artifact_owner = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						this = scope:artifact_1
						this = scope:artifact_2
						this = scope:artifact_3
						AND = {
							artifact_owner = { 
								is_nazgul = yes
							}
							is_nazgul = yes
						}
					}
				}
			}					
			save_scope_as = artifact_4
		}
	}
	
	
	option = { # Artifact 1
		trigger = {
			exists = scope:artifact_1
		}
		name = agent_schemes.0020.a

		ai_chance = {
			base = 100
		}	
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = high_skill_rating
			40 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.a.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}

				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_1.artifact_owner
					}
					set_variable = {
						name = stolen_artifact
						value = scope:artifact_1
					}
					trigger_event = {
						id = agent_schemes.0021
						days = 15
					}	
				}
			}
			60 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.failure.desc
				}
				compare_modifier = {
					value = scope:artifact_1.artifact_owner.intrigue
					multiplier = 3
				}
				modifier = {
					add = scope:artifact_1.artifact_owner.location.title_province.fort_level
					factor = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_1.artifact_owner
					}
					trigger_event = {
						id = agent_schemes.0022
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Artifact 2
		trigger = {
			exists = scope:artifact_2
		}
		name = agent_schemes.0020.b

		root.var:selected_agent = { duel = {
			skill = intrigue
			value = high_skill_rating
			40 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.b.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}

				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_2.artifact_owner
					}
					set_variable = {
						name = stolen_artifact
						value = scope:artifact_2
					}
					trigger_event = {
						id = agent_schemes.0021
						days = 15
					}	
				}
			}
			60 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.failure.desc
				}
				compare_modifier = {
					value = scope:artifact_2.artifact_owner.intrigue
					multiplier = 3
				}
				modifier = {
					add = scope:artifact_2.artifact_owner.location.title_province.fort_level
					factor = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_2.artifact_owner
					}
					trigger_event = {
						id = agent_schemes.0022
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Artifact 3
		trigger = {
			exists = scope:artifact_3
		}
		name = agent_schemes.0020.c

		root.var:selected_agent = { duel = {
			skill = intrigue
			value = high_skill_rating
			40 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.c.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_3.artifact_owner
					}
					set_variable = {
						name = stolen_artifact
						value = scope:artifact_3
					}
					trigger_event = {
						id = agent_schemes.0021
						days = 15
					}	
				}
			}
			60 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.failure.desc
				}
				compare_modifier = {
					value = scope:artifact_3.artifact_owner.intrigue
					multiplier = 3
				}
				modifier = {
					add = scope:artifact_3.artifact_owner.location.title_province.fort_level
					factor = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_3.artifact_owner
					}
					trigger_event = {
						id = agent_schemes.0022
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Artifact 4
		trigger = {
			exists = scope:artifact_4
		}
		name = agent_schemes.0020.d

		root.var:selected_agent = { duel = {
			skill = intrigue
			value = high_skill_rating
			40 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.d.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 4
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_4.artifact_owner
					}
					set_variable = {
						name = stolen_artifact
						value = scope:artifact_4
					}
					trigger_event = {
						id = agent_schemes.0021
						days = 15
					}	
				}
			}
			60 = {
				
				custom_tooltip = {
					text = agent_schemes.0020.failure.desc
				}
				compare_modifier = {
					value = scope:artifact_4.artifact_owner.intrigue
					multiplier = 3
				}
				modifier = {
					add = scope:artifact_4.artifact_owner.location.title_province.fort_level
					factor = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:artifact_4.artifact_owner
					}
					trigger_event = {
						id = agent_schemes.0022
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # On a better thought
		name = agent_schemes.0020.e
		root.var:selected_agent = {
			remove_character_modifier = schemed_recently
		}
	}
}


## Steal artifact: Success
agent_schemes.0021 = {
	title = agent_schemes.success.t
	desc = agent_schemes.success.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = {
		name = agent_schemes.option
		send_interface_toast = {
			title = agent_schemes.0020.tt.success
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim		
			
			root.var:stolen_artifact = {
				set_owner = {
					target = root.var:selected_agent
					history = {
						location = root.var:selected_victim.location
						actor = root.var:selected_victim
						recipient = root.var:selected_agent
						type = stolen
					}
				}
			}				
		}
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0020.revealed_secret.success.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0020.revealed_secret.success.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0020.rumour.t
						desc = agents_quarterly_events_effect.0020.rumour.desc
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}

## Steal artifact: Failure
agent_schemes.0022 = {
	title = agent_schemes.failure.t
	desc = agent_schemes.failure.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = paranoia
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = { # Failure
		name = agent_schemes.option
		send_interface_toast = {					
			title = agent_schemes.0020.tt.failure
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim
			root.var:selected_victim = {
				add_opinion = {
					target = root
					modifier = accused_crime_opinion
					opinion = -25
				}
			}
			root.var:selected_agent = {
				increase_wounds_effect = { REASON = fight }
			}
		}
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0020.revealed_secret.failure.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0020.revealed_secret.failure.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0020.rumour.t
						desc = agents_quarterly_events_effect.0020.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}

# Murder
agent_schemes.0030 = {
	title = agent_schemes.0030.t
	desc = agent_schemes.0030.desc
	type = character_event
	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = assassin
	}
	left_portrait = {
		character = scope:target_1
		animation = bold
	}
	lower_left_portrait = {
		character = scope:target_2
		animation = bold
	}
	lower_center_portrait = {
		character = scope:target_3
		animation = bold
	}
	lower_right_portrait = {
		character = scope:target_4
		animation = bold
	}
	override_background = { reference = drylands }

	immediate = {
		if = {
			limit = {
				NOT = {
					exists = root.var:selected_agent
				}
			}
			if = {
				limit = {
					has_trait = indur_scheme_court
					NOT = {
						has_character_modifier = schemed_recently
					}
				}				
				set_variable = {
					name = selected_agent
					value = root
				}
			}					
			else = {
				random_courtier = {
					limit = {
						has_trait = indur_scheme_court
						NOT = {
							has_character_modifier = schemed_recently
						}
					}
					set_variable = {
						name = selected_agent
						value = this
					}
				}
			}
		}
		if = {
			limit = {
				exists = var:selected_agent
			}
			var:selected_agent = { add_character_modifier = {
				modifier = schemed_recently
				years = 4
			} }
		}
		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}
					}
				}
				save_scope_as = target_1
			}
		}

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
					}
				}
				save_scope_as = target_2
			}
		}	

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
						scope:target_2.top_liege = top_liege
					}
				}
				save_scope_as = target_3
			}
		}	

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
						scope:target_2.top_liege = top_liege
						scope:target_3.top_liege = top_liege
					}
				}
				save_scope_as = target_4
			}
		}	

	}
	

	option = { # Target 1
		trigger = {
			exists = scope:target_1
		}
		name = agent_schemes.0030.a

		ai_chance = {
			base = 100
		}	
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = very_high_skill_rating
			10 = {
				custom_tooltip = {
					text = agent_schemes.0030.a.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_1
					}
					trigger_event = {
						id = agent_schemes.0031
						days = 15
					}	
				}
			}
			20 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.a.partial_success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_1
					}
					trigger_event = {
						id = agent_schemes.0032
						days = 15
					}	
				}
			} 
			70 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.failure.desc
				}
				compare_modifier = {
					value = scope:target_1.intrigue
					multiplier = 3
				}
				compare_modifier = {
					value = scope:target_1.prowess
					multiplier = 3
				}
				modifier = {
					add = scope:target_1.location.title_province.fort_level
					factor = 1.5
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_1
					}
					trigger_event = {
						id = agent_schemes.0033
						days = 15
					}
				}
			}
		}
		}
	}
	
	option = { # Target 2
		trigger = {
			exists = scope:target_2
		}
		name = agent_schemes.0030.b
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = very_high_skill_rating
			10 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.b.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_2
					}
					trigger_event = {
						id = agent_schemes.0031
						days = 15
					}	
				}
			}
			20 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.b.partial_success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_2
					}
					trigger_event = {
						id = agent_schemes.0032
						days = 15
					}	
				}
			} 
			70 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.failure.desc
				}
				compare_modifier = {
					value = scope:target_2.intrigue
					multiplier = 3
				}
				compare_modifier = {
					value = scope:target_2.prowess
					multiplier = 3
				}
				modifier = {
					add = scope:target_2.location.title_province.fort_level
					factor = 1.5
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_2
					}
					trigger_event = {
						id = agent_schemes.0033
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Target 3		
		trigger = {
			exists = scope:target_3
		}
		name = agent_schemes.0030.c
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = very_high_skill_rating
			10 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.c.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_3
					}
					trigger_event = {
						id = agent_schemes.0031
						days = 15
					}	
				}
			}
			20 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.c.partial_success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_3
					}
					trigger_event = {
						id = agent_schemes.0032
						days = 15
					}	
				}
			} 
			70 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.failure.desc
				}
				compare_modifier = {
					value = scope:target_3.intrigue
					multiplier = 3
				}
				compare_modifier = {
					value = scope:target_3.prowess
					multiplier = 3
				}
				modifier = {
					add = scope:target_3.location.title_province.fort_level
					factor = 1.5
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_3
					}
					trigger_event = {
						id = agent_schemes.0033
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Target 4
		trigger = {
			exists = scope:target_4
		}
		name = agent_schemes.0030.d
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = very_high_skill_rating
			10 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.d.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_4
					}
					trigger_event = {
						id = agent_schemes.0031
						days = 15
					}	
				}
			}
			20 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.d.partial_success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 5
				}
				compare_modifier = {
					value = root.var:selected_agent.prowess
					multiplier = 1.2
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_4
					}
					trigger_event = {
						id = agent_schemes.0032
						days = 15
					}	
				}
			} 
			70 = {
				
				custom_tooltip = {
					text = agent_schemes.0030.failure.desc
				}
				compare_modifier = {
					value = scope:target_4.intrigue
					multiplier = 3
				}
				compare_modifier = {
					value = scope:target_4.prowess
					multiplier = 3
				}
				modifier = {
					add = scope:target_4.location.title_province.fort_level
					factor = 1.5
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_4
					}
					trigger_event = {
						id = agent_schemes.0033
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # On a better thought
		name = agent_schemes.0030.e
		root.var:selected_agent = {
			remove_character_modifier = schemed_recently
		}
	}
}

## Steal artifact: Success
agent_schemes.0031 = {
	title = agent_schemes.success.t
	desc = agent_schemes.success.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = assassin
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = dead
	}

	option = {
		name = agent_schemes.option
		send_interface_toast = {
			title = agent_schemes.0030.tt.success
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim
			root.var:selected_victim = {
				death = {
					death_reason = death_assassination
					killer = root.var:selected_agent
				}
			}
		}
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.revealed_secret.success.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0030.revealed_secret.success.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.rumour.t
						desc = agents_quarterly_events_effect.0030.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}


## Steal artifact: Partial Success
agent_schemes.0032 = {
	title = agent_schemes.partial_success.t
	desc = agent_schemes.partial_success.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = assassin
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = fear
	}

	option = {
		name = agent_schemes.option
		send_interface_toast = {
			title = agent_schemes.0030.tt.partial_success
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim		
				
			root.var:selected_victim = {
				increase_wounds_effect = { REASON = murder }
			}
			attempted_murder_opinion_effect = {
				MURDERER = root.var:selected_agent
				VICTIM = root.var:selected_victim	
			}
		}
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.revealed_secret.partial_success.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0030.revealed_secret.partial_success.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.rumour.t
						desc = agents_quarterly_events_effect.0030.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}

## Steal artifact: Failure
agent_schemes.0033 = {
	title = agent_schemes.failure.t
	desc = agent_schemes.failure.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = assassin
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = fear
	}

	option = { # Failure
		name = agent_schemes.option
		send_interface_toast = {					
			title = agent_schemes.0030.tt.failure
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim

			attempted_murder_opinion_effect = {
				MURDERER = root.var:selected_agent
				VICTIM = root.var:selected_victim	
			}
		}
		
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.revealed_secret.failure.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0030.revealed_secret.failure.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0030.rumour.t
						desc = agents_quarterly_events_effect.0030.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}

# Fabricate hooks
agent_schemes.0040 = {
	title = agent_schemes.0040.t
	desc = agent_schemes.0040.desc
	type = character_event
	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = eavesdrop
	}
	left_portrait = {
		character = scope:target_1
		animation = bold
	}
	lower_left_portrait = {
		character = scope:target_2
		animation = bold
	}
	lower_center_portrait = {
		character = scope:target_3
		animation = bold
	}
	lower_right_portrait = {
		character = scope:target_4
		animation = bold
	}
	override_background = { reference = garden }

	immediate = {
		if = {
			limit = {
				NOT = {
					exists = root.var:selected_agent
				}
			}
			if = {
				limit = {
					has_trait = indur_scheme_court
					NOT = {
						has_character_modifier = schemed_recently
					}
				}				
				set_variable = {
					name = selected_agent
					value = root
				}
			}					
			else = {
				random_courtier = {
					limit = {
						has_trait = indur_scheme_court
						NOT = {
							has_character_modifier = schemed_recently
						}
					}
					set_variable = {
						name = selected_agent
						value = this
					}
				}
			}
		}
		if = {
			limit = {
				exists = var:selected_agent
			}
			var:selected_agent = { add_character_modifier = {
				modifier = schemed_recently
				years = 4
			} }
		}
		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}
					}
				}
				save_scope_as = target_1
			}
		}

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
					}
				}
				save_scope_as = target_2
			}
		}	

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
						scope:target_2.top_liege = top_liege
					}
				}
				save_scope_as = target_3
			}
		}	

		random_ruler = {
			random_courtier = {
				limit = {
					NOR = {
						culture = root.location.culture
						#culture_group = root.location.culture_group
						culture = root.culture
						#culture_group = root.culture_group
						faith = root.faith
						top_liege = root.top_liege
						is_wastelands = yes
						
						AND = {
							is_nazgul = yes
							root = {
								is_nazgul = yes
							}
						}

						scope:target_1.top_liege = top_liege
						scope:target_2.top_liege = top_liege
						scope:target_3.top_liege = top_liege
					}
				}
				save_scope_as = target_4
			}
		}	
	}
	

	option = { # Secret Owner 1
		trigger = {
			exists = scope:target_1
		}
		name = agent_schemes.0040.a
		
		ai_chance = {
			base = 100
		}	
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				
				custom_tooltip = {
					text = agent_schemes.0040.a.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_1
					}
					trigger_event = {
						id = agent_schemes.0041
						days = 15
					}
				}
			}
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.failure.desc
				}
				compare_modifier = {
					value = scope:target_1.intrigue
					multiplier = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_1
					}
					trigger_event = {
						id = agent_schemes.0042
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Secret Owner 2
		trigger = {
			exists = scope:target_2
		}
		name = agent_schemes.0040.b
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.b.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_2
					}
					trigger_event = {
						id = agent_schemes.0041
						days = 15
					}
				}
			}
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.failure.desc
				}
				compare_modifier = {
					value = scope:target_2.intrigue
					multiplier = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_2
					}
					trigger_event = {
						id = agent_schemes.0042
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Secret Owner 3
		trigger = {
			exists = scope:target_3
		}
		name = agent_schemes.0040.c
		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.c.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_3
					}
					trigger_event = {
						id = agent_schemes.0041
						days = 15
					}
				}
			}
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.failure.desc
				}
				compare_modifier = {
					value = scope:target_3.intrigue
					multiplier = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_3
					}
					trigger_event = {
						id = agent_schemes.0042
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # Secret Owner 4
		trigger = {
			exists = scope:target_4
		}
		name = agent_schemes.0040.d

		root.var:selected_agent = { duel = {
			skill = intrigue
			value = medium_skill_rating
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.d.success.desc
				}
				modifier = {
					factor = 1.1
					root.var:selected_agent = root
				}
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
				}
				
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_4
					}
					trigger_event = {
						id = agent_schemes.0041
						days = 15
					}
				}
			}
			50 = {
				
				custom_tooltip = {
					text = agent_schemes.0040.failure.desc
				}
				compare_modifier = {
					value = scope:target_4.intrigue
					multiplier = 3
				}
				root = {
					set_variable = {
						name = selected_victim
						value = scope:target_4
					}
					trigger_event = {
						id = agent_schemes.0042
						days = 15
					}
				}
			}
		}
		}
	}

	option = { # On a better thought
		name = agent_schemes.0040.e
		root.var:selected_agent = {
			remove_character_modifier = schemed_recently
		}
	}
}


## Hook fabrication: Success
agent_schemes.0041 = {
	title = agent_schemes.success.t
	desc = agent_schemes.success.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = eavesdrop
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = {
		name = agent_schemes.option
		send_interface_toast = {
			title = agent_schemes.0040.tt.success
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim		
			root = {
				add_hook = {
					type = fabrication_hook
					target = root.var:selected_victim
				}					
			}	
		}
		
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0040.revealed_secret.success.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0040.revealed_secret.success.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0040.rumour.t
						desc = agents_quarterly_events_effect.0040.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}

## Hook fabrication: Failure
agent_schemes.0042 = {
	title = agent_schemes.failure.t
	desc = agent_schemes.failure.desc
	type = character_event

	content_source = realms_dlc
	theme = murder_scheme
	right_portrait = {
		character = root.var:selected_agent
		animation = eavesdrop
	}
	left_portrait = {
		character = root.var:selected_victim
		animation = personality_vengeful
	}

	option = { # Failure
		name = agent_schemes.option
		send_interface_toast = {					
			title = agent_schemes.0040.tt.failure
			left_icon = root.var:selected_agent
			right_icon = root.var:selected_victim
			root.var:selected_victim = {
				add_opinion = {
					target = root
					modifier = accused_crime_opinion
					opinion = -35
				}
			}
		}
		
		hidden_effect = { every_ruler = {
			limit = {
				NOT = {
					this = root
				}
			}
			
			set_variable = {
				name = selected_victim
				value = root.var:selected_victim
			}
			random_list = {
				10 = { 
					modifier = {
						add = cp:councillor_spymaster.intrigue
						exists = cp:councillor_spymaster
					}
					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0040.revealed_secret.failure.t
						
						left_icon = root
						right_icon = root.var:selected_victim
						desc = agents_quarterly_events_effect.0040.revealed_secret.failure.desc
					}
				}
				10 = { 
					modifier = {
						add = intrigue
					}

					send_interface_toast = {
						type = event_generic_neutral_text
						title = agents_quarterly_events_effect.0040.rumour.t
						desc = agents_quarterly_events_effect.0040.rumour.desc
						
						left_icon = root
						right_icon = root.var:selected_victim
					}

				}
				50 = { 

				}
			}
		} }
	}
}